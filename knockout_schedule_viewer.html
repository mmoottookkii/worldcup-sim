<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>æ±ºå‹ãƒˆãƒ¼ãƒŠãƒ¡ãƒ³ãƒˆè¡¨</title>
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@500;700&display=swap" rel="stylesheet" />
<style>
body {
    margin: 0;
    font-family: 'Noto Sans JP', sans-serif;
    background: linear-gradient(to bottom, #0f2027, #203a43, #2c5364);
    color: #fff;
    padding: 1rem;
    display: flex;
    flex-direction: column;
    align-items: center;
}
h1 {
    font-size: 1.5rem;
    margin: 1rem 0;
    color: #ffe066;
}
#matchList {
    width: 100%;
    max-width: 420px;
}
.match {
    background: #ffffff22;
    margin: 0.5rem 0;
    padding: 0.8rem;
    border-radius: 8px;
    text-align: center;
    display: flex;
    flex-direction: column;
    align-items: center;
}
.team-names {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-size: 1.3rem;
    flex-wrap: nowrap;
}

.team-names .vs {
    font-weight: bold;
    font-size: 1.3rem;
}

.team-flags {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1.8rem;
    margin-top: 0.5rem;
}

.team-flags img {
    width: 42px;
    height: 30px;
}

.watch-button {
    background-color: #bce2e8;
    color: #203a43;
    border: none;
    border-radius: 6px;
    padding: 0.4rem 0.8rem;
    font-weight: bold;
    font-size: 0.9rem;
    cursor: pointer;
}

.watch-button:disabled {
    opacity: 0.3;
    cursor: not-allowed;
}
footer {
    margin-top: 2rem;
    color: #ccc;
    font-size: 0.9rem;
    text-align: center;
}

/* ã‚¿ãƒ–é–¢é€£ã®èª¿æ•´ */
.tab-nav {
    display: flex;
    justify-content: center;
    gap: 12px;
    padding: 4px;
    flex-wrap: nowrap;
    flex-shrink: 0;
    overflow-x: auto;
}

.tab-btn {
    background: #ffffff;
    border: 2px solid #007acc;
    //border-radius: 9999px;
    color: #007acc;
    padding: 4px 10px;
    font-size: 0.9rem;
    cursor: pointer;
    transition: background 0.2s, color 0.2s, transform 0.1s;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    white-space: nowrap;
    flex-shrink: 0;
}

.tab-btn:hover {
    background: #007acc;
    color: white;
    transform: translateY(-1px);
}

.tab-btn.active {
    background: #007acc;
    color: white;
    font-weight: bold;
}

.tab-btn.back-btn {
    background: #FF6928;
    border-color: #FF6928;
    color: white;
}

.tab-btn.back-btn:hover {
    background: #d32f2f;
    border-color: #d32f2f;
}

@media (max-width: 400px) {
    .team-names {
        font-size: 1.0rem;
    }
    .team-names .vs {
        font-size: 1.0rem;
    }
    .team-flags img {
        width: 42px;
        height: 30px;
    }
    .watch-button {
        font-size: 0.85rem;
        padding: 0.35rem 0.7rem;
       
    }

    .tab-btn {
        font-size: 0.9rem;
        padding: 3px 8px;
    }
}


</style>
</head>
<body>
<div id="knockoutNav"></div>
<h1 id="roundTitle">ãƒ©ã‚¦ãƒ³ãƒ‰16</h1>
<div id="matchList"></div>
<footer>
  &copy; 2025 ãƒ¯ãƒ¼ãƒ«ãƒ‰ã‚µãƒƒã‚«ãƒ¼ ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³
</footer>
<script>
    const teamNameMap = {
      england: "ã‚¤ãƒ³ã‚°ãƒ©ãƒ³ãƒ‰", germany: "ãƒ‰ã‚¤ãƒ„", france: "ãƒ•ãƒ©ãƒ³ã‚¹", spain: "ã‚¹ãƒšã‚¤ãƒ³", italy: "ã‚¤ã‚¿ãƒªã‚¢",
      netherlands: "ã‚ªãƒ©ãƒ³ãƒ€", portugal: "ãƒãƒ«ãƒˆã‚¬ãƒ«", croatia: "ã‚¯ãƒ­ã‚¢ãƒã‚¢", belgium: "ãƒ™ãƒ«ã‚®ãƒ¼", sweden: "ã‚¹ã‚¦ã‚§ãƒ¼ãƒ‡ãƒ³",
      switzerland: "ã‚¹ã‚¤ã‚¹", poland: "ãƒãƒ¼ãƒ©ãƒ³ãƒ‰", austria: "ã‚ªãƒ¼ã‚¹ãƒˆãƒªã‚¢", denmark: "ãƒ‡ãƒ³ãƒãƒ¼ã‚¯", norway: "ãƒãƒ«ã‚¦ã‚§ãƒ¼",
      ukraine: "ã‚¦ã‚¯ãƒ©ã‚¤ãƒŠ", serbia: "ã‚»ãƒ«ãƒ“ã‚¢", czech: "ãƒã‚§ã‚³", scotland: "ã‚¹ã‚³ãƒƒãƒˆãƒ©ãƒ³ãƒ‰", wales: "ã‚¦ã‚§ãƒ¼ãƒ«ã‚º",
      finland: "ãƒ•ã‚£ãƒ³ãƒ©ãƒ³ãƒ‰", ireland: "ã‚¢ã‚¤ãƒ«ãƒ©ãƒ³ãƒ‰", iceland: "ã‚¢ã‚¤ã‚¹ãƒ©ãƒ³ãƒ‰", greece: "ã‚®ãƒªã‚·ãƒ£", slovakia: "ã‚¹ãƒ­ãƒã‚­ã‚¢",
      slovenia: "ã‚¹ãƒ­ãƒ™ãƒ‹ã‚¢", hungary: "ãƒãƒ³ã‚¬ãƒªãƒ¼", turkey: "ãƒˆãƒ«ã‚³", israel: "ã‚¤ã‚¹ãƒ©ã‚¨ãƒ«", bulgaria: "ãƒ–ãƒ«ã‚¬ãƒªã‚¢",
      romania: "ãƒ«ãƒ¼ãƒãƒ‹ã‚¢", georgia: "ã‚¸ãƒ§ãƒ¼ã‚¸ã‚¢", northmacedonia: "åŒ—ãƒã‚±ãƒ‰ãƒ‹ã‚¢", albania: "ã‚¢ãƒ«ãƒãƒ‹ã‚¢",
      bosnia: "ãƒœã‚¹ãƒ‹ã‚¢", montenegro: "ãƒ¢ãƒ³ãƒ†ãƒã‚°ãƒ­", russia: "ãƒ­ã‚·ã‚¢",
      brazil: "ãƒ–ãƒ©ã‚¸ãƒ«", argentina: "ã‚¢ãƒ«ã‚¼ãƒ³ãƒãƒ³", colombia: "ã‚³ãƒ­ãƒ³ãƒ“ã‚¢", uruguay: "ã‚¦ãƒ«ã‚°ã‚¢ã‚¤", chile: "ãƒãƒª",
      paraguay: "ãƒ‘ãƒ©ã‚°ã‚¢ã‚¤", peru: "ãƒšãƒ«ãƒ¼", ecuador: "ã‚¨ã‚¯ã‚¢ãƒ‰ãƒ«", venezuela: "ãƒ™ãƒã‚ºã‚¨ãƒ©", bolivia: "ãƒœãƒªãƒ“ã‚¢",
      nigeria: "ãƒŠã‚¤ã‚¸ã‚§ãƒªã‚¢", ghana: "ã‚¬ãƒ¼ãƒŠ", egypt: "ã‚¨ã‚¸ãƒ—ãƒˆ", morocco: "ãƒ¢ãƒ­ãƒƒã‚³", tunisia: "ãƒãƒ¥ãƒ‹ã‚¸ã‚¢",
      cameroon: "ã‚«ãƒ¡ãƒ«ãƒ¼ãƒ³", senegal: "ã‚»ãƒã‚¬ãƒ«", algeria: "ã‚¢ãƒ«ã‚¸ã‚§ãƒªã‚¢", mali: "ãƒãƒª", southafrica: "å—ã‚¢ãƒ•ãƒªã‚«",
      ivorycoast: "ã‚³ãƒ¼ãƒˆã‚¸ãƒœãƒ¯ãƒ¼ãƒ«", usa: "ã‚¢ãƒ¡ãƒªã‚«", mexico: "ãƒ¡ã‚­ã‚·ã‚³", canada: "ã‚«ãƒŠãƒ€", jamaica: "ã‚¸ãƒ£ãƒã‚¤ã‚«",
      panama: "ãƒ‘ãƒŠãƒ", honduras: "ãƒ›ãƒ³ã‚¸ãƒ¥ãƒ©ã‚¹", guatemala: "ã‚°ã‚¢ãƒ†ãƒãƒ©", elsalvador: "ã‚¨ãƒ«ã‚µãƒ«ãƒãƒ‰ãƒ«",
      costarica: "ã‚³ã‚¹ã‚¿ãƒªã‚«", australia: "è±ªå·", newzealand: "ãƒ‹ãƒ¥ãƒ¼ã‚¸ãƒ¼ãƒ©ãƒ³ãƒ‰",
      japan: "æ—¥æœ¬", southkorea: "éŸ“å›½", iran: "ã‚¤ãƒ©ãƒ³", iraq: "ã‚¤ãƒ©ã‚¯", qatar: "ã‚«ã‚¿ãƒ¼ãƒ«",
      china: "ä¸­å›½", saudiarabia: "ã‚µã‚¦ã‚¸ã‚¢ãƒ©ãƒ“ã‚¢", northkorea: "åŒ—æœé®®", uae: "UAE", jordan: "ãƒ¨ãƒ«ãƒ€ãƒ³",
      uzbekistan: "ã‚¦ã‚ºãƒ™ã‚­ã‚¹ã‚¿ãƒ³"
    };

const KNOCKOUT_ROUNDS = ["R16", "QF", "SF", "F/3rd"];
const roundTitleMap = {
    "R16": "16å¼·",
    "QF": "8å¼·",
    "SF": "4å¼·",
    "F/3rd": "æ±ºå‹"
};

const roundTitleDisplayMap = {
    "R16": "ãƒ©ã‚¦ãƒ³ãƒ‰16",
    "QF": "æº–ã€…æ±ºå‹",
    "SF": "æº–æ±ºå‹",
    "F/3rd": "3ä½æ±ºå®š & æ±ºå‹"
};

const currentKnockoutRound = localStorage.getItem("currentKnockoutRound") || "R16"; // â˜…â˜…â˜… è¿½åŠ 

function setupKnockoutNav() {
    const nav = document.getElementById("knockoutNav");
    nav.innerHTML = "";
    nav.className = "tab-nav";

    KNOCKOUT_ROUNDS.forEach(round => {
        const btn = document.createElement("button");
        btn.textContent = roundTitleMap[round] || round;
        btn.className = "tab-btn";
        if (round === currentKnockoutRound) {
            btn.classList.add("active");
        }
        btn.onclick = () => {
            localStorage.setItem("currentKnockoutRound", round);
            location.reload();
        };
        nav.appendChild(btn);
    });

    // æˆ»ã‚‹ãƒœã‚¿ãƒ³
    const backBtn = document.createElement("button");
    backBtn.textContent = "æˆ»ã‚‹";
    backBtn.className = "tab-btn back-btn";
    backBtn.onclick = () => {
        location.href = "worldcup_index.html";
    };
    nav.appendChild(backBtn);
}

function navigateKnockout(offset) {
    let current = localStorage.getItem("currentKnockoutRound") || "R16";
    let idx = KNOCKOUT_ROUNDS.indexOf(current);
    idx = Math.max(0, Math.min(KNOCKOUT_ROUNDS.length - 1, idx + offset));
    localStorage.setItem("currentKnockoutRound", KNOCKOUT_ROUNDS[idx]);
    location.reload();
}

setupKnockoutNav();



function idbGet(store, key) {
    return new Promise((resolve) => {
        const req = store.get(key);
        req.onsuccess = () => resolve(req.result);
        req.onerror = () => resolve(null);
    });
}


function updateNextKnockoutFromResult(finishedMatchId, finishedWinner) {
    const dbRequest = indexedDB.open("GameDB", 27);
    dbRequest.onsuccess = () => {
        const db = dbRequest.result;
        const tx = db.transaction(["knockout", "matchresultsknockout"], "readwrite");
        const knockoutStore = tx.objectStore("knockout");
        const resultStore = tx.objectStore("matchresultsknockout");

        if (finishedMatchId.startsWith("SF")) {

            Promise.all([
                idbGet(resultStore, "SF_1"),
                idbGet(resultStore, "SF_2"),
                idbGet(knockoutStore, "SF_1"),
                idbGet(knockoutStore, "SF_2")
            ]).then(([sf1Result, sf2Result, sf1Match, sf2Match]) => {
                const sf1Winner = sf1Result ? sf1Result.winner : null;
                const sf2Winner = sf2Result ? sf2Result.winner : null;

                const sf1Loser = sf1Match ? (sf1Winner === sf1Match.home ? sf1Match.away : sf1Match.home) : null;
                const sf2Loser = sf2Match ? (sf2Winner === sf2Match.home ? sf2Match.away : sf2Match.home) : null;

                // F
                const finalMatch = {
                    matchId: "F",
                    round: "F/3rd",
                    home: sf1Winner,
                    away: sf2Winner
                };
                knockoutStore.put(finalMatch);

                // 3RD
                const thirdMatch = {
                    matchId: "3RD",
                    round: "F/3rd",
                    home: sf1Loser,
                    away: sf2Loser
                };
                knockoutStore.put(thirdMatch);

                console.log("âœ… æ±ºå‹ãƒ»3ä½æ±ºå®šæˆ¦ã‚«ãƒ¼ãƒ‰ç¢ºå®š", finalMatch, thirdMatch);
                renderKnockout();
            });

        } else {
            // R16 / QF
            const mapping = [
                { from: "R16_1", target: "QF_1", side: "home" },
                { from: "R16_2", target: "QF_1", side: "away" },
                { from: "R16_3", target: "QF_2", side: "home" },
                { from: "R16_4", target: "QF_2", side: "away" },
                { from: "R16_5", target: "QF_3", side: "home" },
                { from: "R16_6", target: "QF_3", side: "away" },
                { from: "R16_7", target: "QF_4", side: "home" },
                { from: "R16_8", target: "QF_4", side: "away" },
                { from: "QF_1", target: "SF_1", side: "home" },
                { from: "QF_2", target: "SF_1", side: "away" },
                { from: "QF_3", target: "SF_2", side: "home" },
                { from: "QF_4", target: "SF_2", side: "away" }
            ];

            const related = mapping.filter(m => m.from === finishedMatchId);
            related.forEach(m => {
                const req = knockoutStore.get(m.target);
                req.onsuccess = () => {
                    let match = req.result || {
                        matchId: m.target,
                        round: m.target.startsWith("QF") ? "QF" : "SF"
                    };

                    if (m.side === "home") match.home = finishedWinner;
                    if (m.side === "away") match.away = finishedWinner;
                    knockoutStore.put(match);
                };
            });
        }
    };
}



// ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚¹ã‚³ã‚¢ãŒæ®‹ã£ã¦ã„ã‚‹å ´åˆã®å‡¦ç†
document.addEventListener("DOMContentLoaded", () => {
    const redScore = localStorage.getItem("match_redScore");
    const blueScore = localStorage.getItem("match_blueScore");
    const winner = localStorage.getItem("match_winner");
    const matchId = localStorage.getItem("last-match-knockout-id");
    const round = localStorage.getItem("currentKnockoutRound") || "R16";

    if (redScore !== null && blueScore !== null && winner && matchId) {
        // ä¿å­˜ç”¨ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
        const record = {
            id: matchId,
            matchId: matchId,
            round: round,
            homeScore: parseInt(redScore),
            awayScore: parseInt(blueScore),
            winner: winner,
            timestamp: Date.now()
        };

        // ã‚¹ãƒˆã‚¢ã¸ä¿å­˜
        const dbRequest = indexedDB.open("GameDB", 27);
        dbRequest.onsuccess = () => {
            const db = dbRequest.result;
            const tx = db.transaction("matchresultsknockout", "readwrite");
            const store = tx.objectStore("matchresultsknockout");
            store.put(record);

            tx.oncomplete = () => {
                console.log("âœ… knockoutè©¦åˆçµæœä¿å­˜å®Œäº†");

                // è©¦åˆæƒ…å ±ã‚’Knockoutã‚¹ãƒˆã‚¢ã‹ã‚‰å–å¾—ã—ã¦æ•—è€…ã‚’è¨ˆç®—
                const dbRequest2 = indexedDB.open("GameDB", 27);
                dbRequest2.onsuccess = () => {
                    const db2 = dbRequest2.result;
                    const tx2 = db2.transaction("knockout", "readonly");
                    const store2 = tx2.objectStore("knockout");
                    const getReq = store2.get(matchId);
                    getReq.onsuccess = () => {
                        const matchRecord = getReq.result;
                        if (round === "SF" && matchRecord) {
                            const loser = winner === matchRecord.home ? matchRecord.away : matchRecord.home;
                            localStorage.setItem("lastMatchLoser", loser);
                            console.log("ğŸ’¾ 3ä½æ±ºå®šæˆ¦ç”¨ Loser ä¿å­˜:", loser);
                        }

                        // æ¬¡ãƒ©ã‚¦ãƒ³ãƒ‰æ›´æ–°å‡¦ç†
                        if (round === "R16" || round === "QF" || round === "SF") {
                            updateNextKnockoutFromResult(matchId, winner);
                        }

                        // å†æç”»
                        renderKnockout();

 


// æ±ºå‹å¾Œã®ãƒˆãƒ­ãƒ•ã‚£ãƒ¼è¡¨ç¤ºå®Ÿè¡Œ
if (currentRound === "F/3rd") {
    displayChampionIfFinalFinished();
}



                        // localStorageã®æƒé™¤
                        localStorage.removeItem("match_redScore");
                        localStorage.removeItem("match_blueScore");
                        localStorage.removeItem("match_winner");
                        localStorage.removeItem("last-match-knockout-id");
                    };
                };
            };
        };
    }
});

//const teamNameMap = JSON.parse(localStorage.getItem("teamNameMap")) || {}; // { teamId: "æ—¥æœ¬" }
const currentRound = localStorage.getItem("currentKnockoutRound") || "R16";
//document.getElementById("roundTitle").textContent = roundTitleMap[currentRound] || currentRound;
document.getElementById("roundTitle").textContent = roundTitleDisplayMap[currentRound] || currentRound;

function renderKnockout() {
    const currentKnockoutRound = localStorage.getItem("currentKnockoutRound") || "R16";

    const request = indexedDB.open("GameDB", 27);
    request.onsuccess = () => {
        const db = request.result;
        const tx = db.transaction(["knockout", "matchresultsknockout"], "readonly");
        const store = tx.objectStore("knockout");
        const resultStore = tx.objectStore("matchresultsknockout");

        const index = store.index("by_round");
        const req = index.getAll(currentKnockoutRound);

        req.onsuccess = () => {
            const matches = req.result;

            // è¿½åŠ : matchresultsknockout ã‹ã‚‰çµæœã‚’å–å¾—ã—ã¦çµåˆ
            const resultReq = resultStore.getAll();
            resultReq.onsuccess = () => {
                const results = resultReq.result;

                matches.forEach(match => {
                    const result = results.find(r => r.matchId === match.matchId);
                    if (result) {
                        match.homeScore = result.homeScore;
                        match.awayScore = result.awayScore;
                        match.winner = result.winner;
                    }
                }); 

                const container = document.getElementById("matchList");
                container.innerHTML = "";

                if (matches.length === 0) {
                    // è©¦åˆã‚«ãƒ¼ãƒ‰æœªç”Ÿæˆæ™‚ã®ä»®è¡¨ç¤ºï¼ˆæœ€å¤§4è©¦åˆæƒ³å®šï¼‰
                    for (let i = 0; i < (currentKnockoutRound === "SF" ? 2 : 4); i++) {
                        const matchDiv = document.createElement("div");
                        matchDiv.className = "match";

                        const teamsDiv = document.createElement("div");
                        teamsDiv.className = "teams";
                        teamsDiv.textContent = "æœªæ±ºå®š vs æœªæ±ºå®š";

                        matchDiv.appendChild(teamsDiv);
                        container.appendChild(matchDiv);
                    }
                    return;
                }

                matches.forEach(match => {
                    const matchDiv = document.createElement("div");
                    matchDiv.className = "match";

                        // ä¸Šæ®µ: å›½åA vs å›½åB
    const namesDiv = document.createElement("div");
    namesDiv.className = "team-names";

let homeName = teamNameMap[match.home] || match.home || "æœªæ±ºå®š";
let awayName = teamNameMap[match.away] || match.away || "æœªæ±ºå®š";

// â˜†ãƒãƒ¼ã‚¯ä»˜åŠ å‡¦ç†
if (
    typeof match.homeScore === "number" &&
    typeof match.awayScore === "number" &&
    match.homeScore === match.awayScore &&
    match.winner
) {
    if (match.winner === match.home) {
        homeName += "â˜†";
    } else if (match.winner === match.away) {
        awayName += "â˜†";
    }
}
    
const nameA = document.createElement("span");
nameA.textContent = homeName;
const nameB = document.createElement("span");
nameB.textContent = awayName;

const vs = document.createElement("span");
vs.textContent = match.winner ? `${match.homeScore} - ${match.awayScore}` : "vs";
vs.className = "vs";

namesDiv.appendChild(nameA);
namesDiv.appendChild(vs);
namesDiv.appendChild(nameB);

    // ä¸‹æ®µ: å›½æ——A [è¦³æˆ¦] å›½æ——B
    const flagsDiv = document.createElement("div");
    flagsDiv.className = "team-flags";
    const flagA = document.createElement("img");
    flagA.src = `flags/${match.home || "unknown"}.png`;
    flagA.alt = match.home || "æœªæ±ºå®š";
    const flagB = document.createElement("img");
    flagB.src = `flags/${match.away || "unknown"}.png`;
    flagB.alt = match.away || "æœªæ±ºå®š";

    const watchBtn = document.createElement("button");
    watchBtn.textContent = "è¦³æˆ¦";
    watchBtn.className = "watch-button";
    if (match.winner) {
        watchBtn.disabled = true;
    } else if (match.home && match.away) {
        watchBtn.onclick = () => {
            localStorage.setItem("team-red", match.home);
            localStorage.setItem("team-blue", match.away);
            localStorage.setItem("team-red-jp", teamNameMap[match.home] || match.home);
            localStorage.setItem("team-blue-jp", teamNameMap[match.away] || match.away);
            localStorage.setItem("last-match-knockout-id", match.matchId);
            location.href = "playmatch_watch2knockout.html";
        };
    } else {
        watchBtn.disabled = true;
    }

    flagsDiv.appendChild(flagA);
    flagsDiv.appendChild(watchBtn);
    flagsDiv.appendChild(flagB);

    matchDiv.appendChild(namesDiv);
    matchDiv.appendChild(flagsDiv);
    container.appendChild(matchDiv);
});
            };
        };
    };
}



renderKnockout();


// æ±ºå‹å‹è€…è¡¨ç¤ºï¼‹ã‚¯ãƒªãƒƒã‚¯ã§å›½æ­Œå†ç”Ÿå‡¦ç†
function displayChampionIfFinalFinished() {
    const dbRequest = indexedDB.open("GameDB", 27);
    dbRequest.onsuccess = () => {
        const db = dbRequest.result;
        const tx = db.transaction(["knockout", "matchresultsknockout"], "readonly");
        const knockoutStore = tx.objectStore("knockout");
        const resultStore = tx.objectStore("matchresultsknockout");

        const getFinalMatch = knockoutStore.get("F");
        getFinalMatch.onsuccess = () => {
            const finalMatch = getFinalMatch.result;
            if (!finalMatch || !finalMatch.matchId) return;

            const getResult = resultStore.get("F");
            getResult.onsuccess = () => {
                const result = getResult.result;
                if (result && result.winner) {
                    const winnerId = result.winner;
                    const winnerName = teamNameMap[winnerId] || winnerId;

                    let championContainer = document.getElementById("championContainer");
                    if (!championContainer) {
                        championContainer = document.createElement("div");
                        championContainer.id = "championContainer";
                        championContainer.style.textAlign = "center";
                        championContainer.style.margin = "20px 0";
                        const footer = document.querySelector("footer");
                        footer.parentNode.insertBefore(championContainer, footer);
                    }

                    // cupç”»åƒã«ã‚¯ãƒªãƒƒã‚¯å†ç”Ÿæ©Ÿèƒ½ã‚’ä»˜ä¸
                    championContainer.innerHTML = `
                        <img id="championCup" src="cup.png" alt="Champion Cup" style="width:100px; cursor: pointer;"><br>
                        <span style="font-size: 1.5em; font-weight: bold;">å„ªå‹å›½ ${winnerName}</span>
                        <div style="font-size:0.9em; color:#555;">â€»ã‚¯ãƒªãƒƒã‚¯ã§å›½æ­Œå†ç”Ÿ</div>
                    `;

                    const cupImg = document.getElementById("championCup");
                    const audio = new Audio(`anthem/${winnerId}.mp3`);

                    cupImg.addEventListener("click", () => {
                        audio.play().catch(err => {
                            alert("å†ç”Ÿã§ãã¾ã›ã‚“ã§ã—ãŸã€‚åˆ¥ã®ãƒ–ãƒ©ã‚¦ã‚¶ã§è©¦ã—ã¦ãã ã•ã„ã€‚");
                            console.log(err);
                        });
                    });
                }
            };
        };
    };
}


if (currentRound === "F/3rd") {
    displayChampionIfFinalFinished();
}

</script>
</body>
</html>
